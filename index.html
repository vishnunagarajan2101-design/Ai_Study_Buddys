<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Tutor - Premium Edition</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

    <!-- Icons (using Cloudflare CDN for FontAwesome Free) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="profile-section">
                <!-- AI Avatar Icon -->
                <div style="font-size: 3em; margin-bottom: 10px; text-shadow: 0 0 20px #7B2CBF;">ðŸ¤–</div>
                <h2>AI Tutor</h2>
                <div class="user-id-badge">ID: <span id="my-user-id">Loading...</span></div>
            </div>

            <nav>
                <button class="nav-btn active" onclick="showSection('chat')">
                    <i class="fa-solid fa-comments"></i> Chat
                </button>
                <button class="nav-btn" onclick="showSection('analysis')">
                    <i class="fa-solid fa-chart-line"></i> Focus Analysis
                </button>
                <button class="nav-btn" onclick="showSection('study')">
                    <i class="fa-solid fa-graduation-cap"></i> AI Tutor
                </button>
            </nav>

            <div
                style="margin-top: auto; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 15px; font-size: 0.8em; color: #B8B8FF;">
                <i class="fa-solid fa-bolt" style="color: #4CC9F0;"></i> <b>Pro Tip:</b><br>
                Try asking about complex topics like "Quantum Mechanics" for Wikipedia-powered answers!
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">

            <!-- Chat Section -->
            <div id="chat-section" class="section active">
                <div class="chat-header">
                    <input type="text" id="target-id-input" placeholder="Enter Friend's ID..." style="flex: 1;">
                    <button class="primary" onclick="setChatTarget()"><i class="fa-solid fa-paper-plane"></i>
                        Start</button>
                </div>

                <div id="active-chat-status" style="margin-bottom:10px; font-size: 0.9em; color: var(--text-muted);">
                    No active chat. Enter an ID above.
                </div>

                <div class="chat-window" id="chat-window">
                    <div style="text-align: center; color: var(--text-muted); margin-top: 50px;">
                        <i class="fa-regular fa-comments" style="font-size: 3em; opacity: 0.5;"></i><br><br>
                        Start a conversation! Messages are encrypted & private.
                    </div>
                </div>

                <div class="chat-input-area">
                    <input type="text" id="message-input" placeholder="Type a message..." style="flex: 1;"
                        onkeypress="handleEnter(event)">
                    <button class="primary" onclick="sendMessage()"><i class="fa-solid fa-share"></i> Send</button>
                </div>
            </div>

            <!-- Analysis Section -->
            <div id="analysis-section" class="section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <div>
                        <h1>Focus Analytics</h1>
                        <p style="color: var(--text-muted);">Real-time insights based on your study habits.</p>
                    </div>
                    <button class="primary" onclick="runAnalysis()">
                        <i class="fa-solid fa-rotate-right"></i> Refresh
                    </button>
                </div>

                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="focus-score">--</div>
                        <div><i class="fa-solid fa-brain"></i> Focus Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="study-count">--</div>
                        <div><i class="fa-solid fa-book-open"></i> Study Msgs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="distract-count">--</div>
                        <div><i class="fa-solid fa-gamepad"></i> Distractions</div>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Filters</h3>
                <div
                    style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                    <button onclick="setFilter('all')" class="filter-btn active">All Time</button>
                    <button onclick="setFilter('today')" class="filter-btn">Today</button>
                    <button onclick="setFilter('week')" class="filter-btn">Last 7 Days</button>

                    <div style="margin-left: auto; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 0.9em; color: var(--text-muted);">Custom Range:</span>
                        <input type="date" id="start-date" style="padding: 8px;">
                        <span style="color: var(--text-muted);">-</span>
                        <input type="date" id="end-date" style="padding: 8px;">
                        <button onclick="setFilter('custom')" class="primary" style="padding: 8px 15px;">Apply</button>
                    </div>
                </div>

                <div id="insight-box" class="insight-box"
                    style="display: none; border-left: 4px solid var(--accent-color);">
                    <i class="fa-solid fa-lightbulb" style="color: yellow; margin-right: 10px;"></i>
                    <strong>AI Insight:</strong> <span id="insight-text"></span>
                </div>
            </div>

            <!-- Study Buddy Section -->
            <div id="study-section" class="section">
                <div style="text-align: center; margin-bottom: 40px;">
                    <h1><i class="fa-solid fa-robot"></i> AI Tutor</h1>
                    <p style="color: var(--text-muted); max-width: 600px; margin: 0 auto;">
                        Powered by Wikipedia & Custom Knowledge Graph. Ask me anything!
                    </p>
                </div>

                <div class="study-buddy-container">
                    <div
                        style="display: flex; gap: 15px; margin-bottom: 30px; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 15px;">
                        <input type="text" id="topic-input"
                            placeholder="Search any topic (e.g. Calculus, Solar System)..."
                            style="flex: 2; border: none; background: transparent;">
                        <select id="level-select" style="flex: 1; border: none; background: rgba(255,255,255,0.05);">
                            <option value="Basic">Beginner</option>
                            <option value="Intermediate">Intermediate</option>
                            <option value="Advanced">Advanced</option>
                        </select>
                        <button class="primary" onclick="getExplanation()" style="border-radius: 10px;">
                            <i class="fa-solid fa-magnifying-glass"></i> Explain
                        </button>
                    </div>

                    <div id="explanation-output" class="explanation-result"
                        style="display:none; animation: slideIn 0.5s ease;">
                        <h2 id="exp-title"></h2>
                        <div id="exp-content"></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>